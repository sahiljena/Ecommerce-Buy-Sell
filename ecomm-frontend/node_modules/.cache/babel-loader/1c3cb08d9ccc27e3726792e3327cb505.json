{"ast":null,"code":"import _asyncToGenerator from\"C:\\\\Users\\\\ASUS\\\\OneDrive\\\\Desktop\\\\olx-clone\\\\ecomm-frontend\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";import _slicedToArray from\"C:\\\\Users\\\\ASUS\\\\OneDrive\\\\Desktop\\\\olx-clone\\\\ecomm-frontend\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\ASUS\\\\OneDrive\\\\Desktop\\\\olx-clone\\\\ecomm-frontend\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useState,useEffect}from\"react\";import Navbar from\"../components/Navbar\";import{useNavigate}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var NewListing=function NewListing(_ref){var token=_ref.token,setToken=_ref.setToken;var navigate=useNavigate();var _useState=useState(''),_useState2=_slicedToArray(_useState,2),pName=_useState2[0],setPName=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),productImage=_useState4[0],setProductImage=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),category=_useState6[0],setCategory=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),description=_useState8[0],setDescription=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),expPrice=_useState10[0],setExpPrice=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),age=_useState12[0],setAge=_useState12[1];var _useState13=useState(''),_useState14=_slicedToArray(_useState13,2),imagePreview=_useState14[0],setImagePreview=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),laoding=_useState16[0],setLoading=_useState16[1];var _useState17=useState(''),_useState18=_slicedToArray(_useState17,2),status=_useState18[0],setStatus=_useState18[1];var _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),error=_useState20[0],setError=_useState20[1];var _useState21=useState(false),_useState22=_slicedToArray(_useState21,2),success=_useState22[0],setSuccess=_useState22[1];var _useState23=useState(\"\"),_useState24=_slicedToArray(_useState23,2),uploadedImg=_useState24[0],setUploadedImg=_useState24[1];useEffect(function(){if(!token){return navigate('/login');}},[token]);if(!token){navigate('/login');}var handleProductAdd=function handleProductAdd(event){event.preventDefault();setLoading(true);console.log(uploadedImg);//console.log(token)\nsetError(false);if(pName&&productImage&&category&&description&&expPrice&&age){fetch('http://localhost:5000/api/listing/new',{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(token)},body:JSON.stringify({title:pName,category:category,description:description,expectedPrice:expPrice,productAge:age,productImg:uploadedImg})}).then(function(response){return response.json();})//Then with the data from the response in JSON...\n.then(function(data){if(data.message===\"Product listed successfully\"){setLoading(false);setStatus(\"Product listed successfully\");setSuccess(true);window.scrollTo({top:0,behavior:'smooth'});}else{setLoading(false);setError(true);setStatus('Something went wrong.');window.scrollTo({top:0,behavior:'smooth'});}return console.log(data);})//Then with the error genereted...\n.catch(function(error){console.error(error);});setLoading(false);setStatus('Posting AD...');}else{setLoading(false);setError(true);setStatus('All the fields are required.');window.scrollTo({top:0,behavior:'smooth'});}};var handleProductImageChange=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var formData,resp,img;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoading(true);setImagePreview(URL.createObjectURL(event.target.files[0]));setProductImage(event.target.files[0]);formData=new FormData();formData.append(\"productImg\",event.target.files[0]);console.log(formData);_context.next=8;return fetch('http://localhost:5000/api/listing/newImg',{method:'POST',headers:{// 'Content-Type': 'multipart/form-data',\n'Authorization':\"Bearer \".concat(token)},body:formData});case 8:resp=_context.sent;_context.next=11;return resp.json();case 11:img=_context.sent;setUploadedImg(img.uploaded_img);console.log(img.uploaded_img);console.log(uploadedImg);setLoading(false);return _context.abrupt(\"return\",uploadedImg);case 17:case\"end\":return _context.stop();}}},_callee);}));return function handleProductImageChange(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Navbar,{setToken:setToken,token:token}),/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center mt-10\",children:/*#__PURE__*/_jsx(\"div\",{class:\"w-full max-w-xl\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleProductAdd,className:\"bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4\",enctype:\"multipart/form-data\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[error&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-300 text-base text-white rounded px-1 py-1\",children:status}),success&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-green-500 text-base text-white rounded px-1 py-1\",children:status})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 text-center text-lg font-bold text-gray-600\",children:/*#__PURE__*/_jsx(\"h2\",{children:\"Add a new product to sell.\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-bold tracking-tight text-gray-500 mb-2\",for:\"pname\",children:\"Product Name\"}),/*#__PURE__*/_jsx(\"input\",{className:\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\",id:\"pname\",type:\"text\",placeholder:\"Product Name\",value:pName,onChange:function onChange(e){return setPName(e.target.value);}}),/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-xs italic\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-bold tracking-tight text-gray-500 mb-2\",for:\"category\",children:\"Product Category\"}),/*#__PURE__*/_jsxs(\"select\",{onChange:function onChange(e){setCategory(e.target.value);},name:\"category\",id:\"category\",className:\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\",children:[/*#__PURE__*/_jsx(\"option\",{disabled:true,selected:true,value:category,children:\" -- select an option -- \"}),/*#__PURE__*/_jsx(\"option\",{value:\"mobile\",children:\"Mobile\"}),/*#__PURE__*/_jsx(\"option\",{value:\"laptop\",children:\"Laptop\"}),/*#__PURE__*/_jsx(\"option\",{value:\"books\",children:\"Book\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-xs italic\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-bold tracking-tight text-gray-500 mb-2\",for:\"description\",children:\"Description\"}),/*#__PURE__*/_jsx(\"textarea\",{value:description,onChange:function onChange(e){setDescription(e.target.value);},className:\" shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-xs italic\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-bold tracking-tight text-gray-500 mb-2\",for:\"expPrice\",children:\"Expected Price\"}),/*#__PURE__*/_jsx(\"input\",{className:\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\",id:\"expPrice\",type:\"number\",placeholder:\"Rs1000\",value:expPrice,onChange:function onChange(e){return setExpPrice(e.target.value);}}),/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-xs italic\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-bold tracking-tight text-gray-500 mb-2\",for:\"age\",children:\"How old is your product?\"}),/*#__PURE__*/_jsx(\"input\",{className:\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\",id:\"age\",type:\"number\",placeholder:\"10 yrs old\",value:age,onChange:function onChange(e){return setAge(e.target.value);}}),/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-xs italic\"})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"max-w-2xl rounded-lg\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"m-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"inline-block mb-2 text-gray-500\",children:\"Add product image\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center w-full\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"flex flex-col w-full h-32 border-4 border-blue-200 border-dashed hover:bg-gray-100 hover:border-gray-300\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center justify-center pt-7\",children:[/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"w-8 h-8 text-gray-400 group-hover:text-gray-600\",fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12\"})}),/*#__PURE__*/_jsx(\"p\",{className:\"pt-1 text-sm tracking-wider text-gray-400 group-hover:text-gray-600\",children:\"Attach a file\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",className:\"opacity-0\",onChange:handleProductImageChange})]})}),imagePreview?/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"w-full p-2 rounded lg:w-1/3 md:w-1/3 md:h-1/5\",src:imagePreview}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"button\",{className:\"underline decoration-dashed text-red-600\",onClick:function onClick(){setProductImage('');setImagePreview('');},children:\"Remove\"})]}):/*#__PURE__*/_jsx(_Fragment,{})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center\",children:success?/*#__PURE__*/_jsx(_Fragment,{}):/*#__PURE__*/_jsx(\"button\",{className:\"w-full bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline\",type:\"submit\",disabled:laoding,children:laoding?/*#__PURE__*/_jsx(_Fragment,{children:\"Please wait ...\"}):/*#__PURE__*/_jsx(_Fragment,{children:\"Post\"})})})]})})})]});};export default NewListing;","map":{"version":3,"sources":["C:/Users/ASUS/OneDrive/Desktop/olx-clone/ecomm-frontend/src/pages/NewListing.js"],"names":["React","useState","useEffect","Navbar","useNavigate","NewListing","token","setToken","navigate","pName","setPName","productImage","setProductImage","category","setCategory","description","setDescription","expPrice","setExpPrice","age","setAge","imagePreview","setImagePreview","laoding","setLoading","status","setStatus","error","setError","success","setSuccess","uploadedImg","setUploadedImg","handleProductAdd","event","preventDefault","console","log","fetch","method","headers","body","JSON","stringify","title","expectedPrice","productAge","productImg","then","response","json","data","message","window","scrollTo","top","behavior","catch","handleProductImageChange","URL","createObjectURL","target","files","formData","FormData","append","resp","img","uploaded_img","e","value"],"mappings":"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","sourcesContent":["import { func } from \"prop-types\";\r\nimport React,{useState, useEffect} from \"react\";\r\nimport Navbar from \"../components/Navbar\";\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nconst NewListing = ({token, setToken}) =>{\r\n\r\n    const navigate = useNavigate();\r\n\r\n    \r\n\r\n\r\n    const [pName, setPName] = useState('');\r\n    const [productImage, setProductImage] = useState('');\r\n    const [category, setCategory] = useState('');\r\n    const [description, setDescription] = useState('');\r\n    const [expPrice, setExpPrice] = useState('');\r\n    const [age, setAge] = useState('');\r\n    const [imagePreview, setImagePreview] = useState('');\r\n\r\n    const [laoding, setLoading] = useState(false);\r\n    const [status, setStatus] = useState('');\r\n    const [error, setError] = useState(false);\r\n    const [success,setSuccess] = useState(false);\r\n    const[uploadedImg, setUploadedImg] = useState(\"\");\r\n\r\n    useEffect(() => {\r\n        if(!token){\r\n            return (navigate('/login'));\r\n        }\r\n    }, [token])\r\n\r\n    if(!token){\r\n        navigate('/login');\r\n    }\r\n\r\n    const handleProductAdd = (event) =>{\r\n        event.preventDefault();\r\n        setLoading(true);\r\n        console.log(uploadedImg);\r\n        //console.log(token)\r\n        setError(false);\r\n        if(pName&&productImage&&category&&description&&expPrice&&age){\r\n\r\n            fetch('http://localhost:5000/api/listing/new',{\r\n                method:'POST',\r\n                headers:{\r\n                    'Content-Type': 'application/json',\r\n                    'Authorization':`Bearer ${token}`,\r\n                },\r\n                body: JSON.stringify({\r\n                    title:pName,\r\n                    category:category,\r\n                    description:description,\r\n                    expectedPrice:expPrice,\r\n                    productAge:age,\r\n                    productImg:uploadedImg,\r\n                })\r\n            })\r\n            .then(function (response) {\r\n                return response.json();\r\n            })\r\n            //Then with the data from the response in JSON...\r\n            .then((data) => {\r\n                if(data.message===\"Product listed successfully\"){\r\n                    setLoading(false);\r\n                    setStatus(\"Product listed successfully\");\r\n                    setSuccess(true);\r\n                    window.scrollTo({ top: 0, behavior: 'smooth' });\r\n                }\r\n                else{\r\n                    setLoading(false);\r\n                    setError(true);\r\n                    setStatus('Something went wrong.');\r\n                    window.scrollTo({ top: 0, behavior: 'smooth' });\r\n                }\r\n                return console.log(data);\r\n            })\r\n            //Then with the error genereted...\r\n            .catch((error) => {\r\n                console.error(error);\r\n            });\r\n            setLoading(false);\r\n            setStatus('Posting AD...');\r\n        }else{\r\n            setLoading(false);\r\n            setError(true);\r\n            setStatus('All the fields are required.');\r\n            window.scrollTo({ top: 0, behavior: 'smooth' });\r\n        }\r\n    }\r\n\r\n    const handleProductImageChange = async (event) => {\r\n        setLoading(true)\r\n        setImagePreview(URL.createObjectURL(event.target.files[0]));\r\n        setProductImage(event.target.files[0]);\r\n        let formData = new FormData();\r\n\r\n        formData.append(\"productImg\",event.target.files[0]);\r\n        console.log(formData)\r\n        const resp = await fetch('http://localhost:5000/api/listing/newImg',{\r\n                                method:'POST',\r\n                                headers:{\r\n                                    // 'Content-Type': 'multipart/form-data',\r\n                                    'Authorization':`Bearer ${token}`,\r\n                                },\r\n                                body: formData,\r\n                            })\r\n        const img = await resp.json();\r\n        setUploadedImg(img.uploaded_img);\r\n        console.log(img.uploaded_img);\r\n        console.log(uploadedImg);\r\n        setLoading(false);\r\n        return uploadedImg;\r\n            // .then((data)=>{\r\n            //     return data.json()\r\n            // })\r\n            // .then((j)=>{\r\n            //     //console.log(j);\r\n            //     //console.log(JSON.stringify(j));\r\n            //     setUploadedImg(JSON.stringify(j));\r\n            //     console.log(\"Inside THEN\",uploadedImg);\r\n            //     return \"IMAGE UPLOADED\"\r\n            // })\r\n            \r\n\r\n    }\r\n\r\n\r\n\r\n    return(\r\n        <>\r\n            <Navbar setToken={setToken} token={token} />\r\n            <div className='flex justify-center mt-10'>\r\n\r\n                <div class=\"w-full max-w-xl\">\r\n\r\n                    <form onSubmit={handleProductAdd} className=\"bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4\" enctype=\"multipart/form-data\">\r\n\r\n                        <div className=\"mb-4\">\r\n                            {error&&<div className='bg-red-300 text-base text-white rounded px-1 py-1'>\r\n                                {status}\r\n                            </div>\r\n                            }\r\n                            {success&&<div className='bg-green-500 text-base text-white rounded px-1 py-1'>\r\n                                {status}\r\n                            </div>\r\n                            }\r\n                        </div>\r\n\r\n                        <div className='mb-4 text-center text-lg font-bold text-gray-600'>\r\n                            <h2>Add a new product to sell.</h2>\r\n                        </div>\r\n\r\n\r\n                        <div className=\"mb-4\">\r\n                            <label className=\"block text-sm font-bold tracking-tight text-gray-500 mb-2\" for=\"pname\">\r\n                                Product Name\r\n                            </label>\r\n                            <input \r\n                                className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\" \r\n                                id=\"pname\" \r\n                                type=\"text\" \r\n                                placeholder=\"Product Name\"\r\n                                value = {pName}\r\n                                onChange={(e)=>setPName(e.target.value)}\r\n                            />\r\n                            <p className=\"text-red-500 text-xs italic\"></p>\r\n                        </div>\r\n\r\n                        <div className=\"mb-4\">\r\n                            <label className=\"block text-sm font-bold tracking-tight text-gray-500 mb-2\" for=\"category\">\r\n                                Product Category\r\n                            </label>\r\n                            <select  onChange={(e)=>{setCategory(e.target.value)}} name=\"category\" id=\"category\" className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\">\r\n                                <option disabled selected value={category}> -- select an option -- </option>\r\n                                <option value=\"mobile\">Mobile</option>\r\n                                <option value=\"laptop\">Laptop</option>\r\n                                <option value=\"books\">Book</option>\r\n                            </select>\r\n                            <p className=\"text-red-500 text-xs italic\"></p>\r\n                        </div>\r\n\r\n                        <div className=\"mb-4\">\r\n                            <label className=\"block text-sm font-bold tracking-tight text-gray-500 mb-2\" for=\"description\">\r\n                                Description\r\n                            </label>\r\n                            <textarea value={description} onChange={(e)=>{setDescription(e.target.value)}} className=\" shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"></textarea>\r\n                            <p className=\"text-red-500 text-xs italic\"></p>\r\n                        </div>\r\n\r\n                        <div className=\"mb-4\">\r\n                            <label className=\"block text-sm font-bold tracking-tight text-gray-500 mb-2\" for=\"expPrice\">\r\n                                Expected Price \r\n                            </label>\r\n                            <input \r\n                                className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\" \r\n                                id=\"expPrice\" \r\n                                type=\"number\" \r\n                                placeholder=\"Rs1000\"\r\n                                value = {expPrice}\r\n                                onChange={(e)=>setExpPrice(e.target.value)}\r\n                            />\r\n                            <p className=\"text-red-500 text-xs italic\"></p>\r\n                        </div>\r\n\r\n                        <div className=\"mb-4\">\r\n                            <label className=\"block text-sm font-bold tracking-tight text-gray-500 mb-2\" for=\"age\">\r\n                                How old is your product? \r\n                            </label>\r\n                            <input \r\n                                className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\" \r\n                                id=\"age\" \r\n                                type=\"number\" \r\n                                placeholder=\"10 yrs old\"\r\n                                value = {age}\r\n                                onChange={(e)=>setAge(e.target.value)}\r\n                            />\r\n                            <p className=\"text-red-500 text-xs italic\"></p>\r\n                        </div>\r\n\r\n                        \r\n\r\n                        <br />\r\n                        \r\n                        <div className=\"max-w-2xl rounded-lg\">\r\n                            <div className=\"m-4\">\r\n                                <label className=\"inline-block mb-2 text-gray-500\">Add product image</label>\r\n                                <div className=\"flex items-center justify-center w-full\">\r\n                                <label className=\"flex flex-col w-full h-32 border-4 border-blue-200 border-dashed hover:bg-gray-100 hover:border-gray-300\">\r\n                                    <div className=\"flex flex-col items-center justify-center pt-7\">\r\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"w-8 h-8 text-gray-400 group-hover:text-gray-600\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12\" />\r\n                                    </svg>\r\n                                    <p className=\"pt-1 text-sm tracking-wider text-gray-400 group-hover:text-gray-600\">\r\n                                        Attach a file</p>\r\n                                    </div>\r\n                                    <input type=\"file\" className=\"opacity-0\" \r\n                                    onChange={handleProductImageChange} \r\n                                    />\r\n                                </label>\r\n                                </div>\r\n                                {imagePreview?<div className=\"mb-4\">\r\n                                    <img className=\"w-full p-2 rounded lg:w-1/3 md:w-1/3 md:h-1/5\" src={imagePreview} />\r\n                                    <br />\r\n                                    <button className=\"underline decoration-dashed text-red-600\" onClick={()=>{setProductImage('');setImagePreview('');}}>Remove</button>\r\n                                </div>:<></>}\r\n                            </div>\r\n                        </div>\r\n                        \r\n\r\n                        <div className=\"flex items-center justify-center\">\r\n                            {success?<></>:<button \r\n                                className=\"w-full bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline\" \r\n                                type=\"submit\"\r\n                                disabled={laoding}\r\n                            >\r\n                                {laoding?<>Please wait ...</>:<>Post</>}\r\n                            </button>}\r\n                        </div>\r\n                    </form>\r\n                </div>\r\n            </div>\r\n        </>\r\n    );\r\n}\r\n\r\nexport default NewListing;"]},"metadata":{},"sourceType":"module"}