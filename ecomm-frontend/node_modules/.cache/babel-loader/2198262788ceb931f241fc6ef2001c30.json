{"ast":null,"code":"import _defineProperty from\"C:\\\\Users\\\\ASUS\\\\OneDrive\\\\Desktop\\\\olx-clone\\\\ecomm-frontend\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\defineProperty.js\";import _asyncToGenerator from\"C:\\\\Users\\\\ASUS\\\\OneDrive\\\\Desktop\\\\olx-clone\\\\ecomm-frontend\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";import _slicedToArray from\"C:\\\\Users\\\\ASUS\\\\OneDrive\\\\Desktop\\\\olx-clone\\\\ecomm-frontend\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\ASUS\\\\OneDrive\\\\Desktop\\\\olx-clone\\\\ecomm-frontend\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useState,useEffect}from\"react\";import Navbar from\"../components/Navbar\";import{useNavigate}from\"react-router-dom\";import Product from'../components/Productcard';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var MyListings=function MyListings(_ref){var token=_ref.token,setToken=_ref.setToken;var navigate=useNavigate();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),listings=_useState4[0],setListings=_useState4[1];var fetchListings=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,tours;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoading(true);_context.prev=1;_context.next=4;return fetch('https://ecomm-backend-xcv34.herokuapp.com/api/listings/my',{headers:{'Authorization':\"Bearer \".concat(token)}});case 4:response=_context.sent;_context.next=7;return response.json();case 7:tours=_context.sent;//console.log(tours)\nsetLoading(false);setListings(tours);_context.next=17;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](1);setLoading(false);console.log(\"Error Occured\");console.log(_context.t0);case 17:case\"end\":return _context.stop();}}},_callee,null,[[1,12]]);}));return function fetchListings(){return _ref2.apply(this,arguments);};}();useEffect(function(){if(!token){return navigate('/login');}fetchListings();},[token]);var handleDelete=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(id){var response,tours;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setLoading(true);_context2.prev=1;_context2.next=4;return fetch('https://ecomm-backend-xcv34.herokuapp.com/api/listings/delete',{method:\"POST\",headers:{'Authorization':\"Bearer \".concat(token),'Content-Type':'application/json'},body:JSON.stringify({id:id})});case 4:response=_context2.sent;_context2.next=7;return response.json();case 7:tours=_context2.sent;console.log(tours);setLoading(false);setListings(tours);_context2.next=18;break;case 13:_context2.prev=13;_context2.t0=_context2[\"catch\"](1);setLoading(false);console.log(\"Error Occured\");console.log(_context2.t0);case 18:case\"end\":return _context2.stop();}}},_callee2,null,[[1,13]]);}));return function handleDelete(_x){return _ref3.apply(this,arguments);};}();if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"grid justify-items-center items-center h-screen\",children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-center text-xl\",children:\"Loading..\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm\",children:\"this might take a few minutes\"})]})});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Navbar,{setToken:setToken,token:token}),/*#__PURE__*/_jsx(\"div\",{class:\"grid 2xl:grid-cols-5 xl:grid-cols-4 lg:grid-cols-3 sm:grid-cols-2 grid-cols-1 gap-x-6 gap-y-12 w-full mt-6 md:px-15 px-5 py-10\",children:listings.length>0?/*#__PURE__*/_jsx(_Fragment,{children:listings.map(function(data){console.log(data._id);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(Product,_defineProperty({nav:data._id,img:data.prodcutImg,title:data.title,description:data.description,price:data.expectedPrice,old:data.productAge,deleteListing:function deleteListing(){return handleDelete(data._id);},delButton:true},\"img\",data.prodcutImg))});})}):/*#__PURE__*/_jsx(\"p\",{className:\"text-center\",children:\"Nothing to show!\"})})]});};export default MyListings;","map":{"version":3,"sources":["C:/Users/ASUS/OneDrive/Desktop/olx-clone/ecomm-frontend/src/pages/Mylistings.js"],"names":["React","useState","useEffect","Navbar","useNavigate","Product","MyListings","token","setToken","navigate","loading","setLoading","listings","setListings","fetchListings","fetch","headers","response","json","tours","console","log","handleDelete","id","method","body","JSON","stringify","length","map","data","_id","prodcutImg","title","description","expectedPrice","productAge"],"mappings":"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","sourcesContent":["import React,{useState,  useEffect} from \"react\";\r\nimport Navbar from \"../components/Navbar\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport Product from '../components/Productcard';\r\nconst MyListings = ({token , setToken }) =>{\r\n\r\n    const navigate = useNavigate();\r\n\r\n    const [loading, setLoading] = useState(false);\r\n    const [listings, setListings] = useState([]);\r\n\r\n    \r\n\r\n    const fetchListings = async () =>{\r\n        setLoading(true)\r\n        try{\r\n            const response = await fetch('https://ecomm-backend-xcv34.herokuapp.com/api/listings/my',{\r\n                headers:{\r\n                    'Authorization' : `Bearer ${token}`\r\n                }\r\n            })\r\n            const tours = await response.json()\r\n            //console.log(tours)\r\n            setLoading(false)\r\n            setListings(tours)\r\n        } catch(error){\r\n            setLoading(false)\r\n            console.log(\"Error Occured\");\r\n            console.log(error);\r\n        }\r\n    }\r\n    useEffect(() => {\r\n        if(!token){\r\n            return (navigate('/login'));\r\n        }\r\n        fetchListings()\r\n    }, [token])\r\n\r\n    const handleDelete = async (id) =>{\r\n        setLoading(true)\r\n        try{\r\n            const response = await fetch('https://ecomm-backend-xcv34.herokuapp.com/api/listings/delete',{\r\n                method:\"POST\",\r\n                headers:{\r\n                    'Authorization' : `Bearer ${token}`,\r\n                    'Content-Type': 'application/json'\r\n                },\r\n                body:JSON.stringify({\r\n                    id:id\r\n                })\r\n            })\r\n            const tours = await response.json()\r\n            console.log(tours)\r\n            setLoading(false)\r\n            setListings(tours)\r\n        } catch(error){\r\n            setLoading(false)\r\n            console.log(\"Error Occured\");\r\n            console.log(error);\r\n        }\r\n    }\r\n\r\n    if(loading){\r\n        return (\r\n            <div className=\"grid justify-items-center items-center h-screen\">\r\n                <div>\r\n                    <h3 className=\"text-center text-xl\">Loading..</h3>\r\n                    <p className=\"text-sm\">this might take a few minutes</p>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n    return(\r\n        <>\r\n        <Navbar setToken={setToken} token={token} />\r\n        <div class=\"grid 2xl:grid-cols-5 xl:grid-cols-4 lg:grid-cols-3 sm:grid-cols-2 grid-cols-1 gap-x-6 gap-y-12 w-full mt-6 md:px-15 px-5 py-10\">\r\n            {listings.length>0?<>\r\n                {listings.map((data)=>{\r\n                    console.log(data._id);\r\n                    return <>\r\n                        <Product nav={data._id} img={data.prodcutImg} title={data.title} description={data.description} price={data.expectedPrice} old={data.productAge} deleteListing={()=>handleDelete(data._id)} delButton={true} img={data.prodcutImg} />\r\n                    </>\r\n                })}\r\n                </>:<p className=\"text-center\">Nothing to show!</p>\r\n            }\r\n        </div>\r\n        </>\r\n    );\r\n}\r\n\r\nexport default MyListings;"]},"metadata":{},"sourceType":"module"}